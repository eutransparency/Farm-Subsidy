{% extends "base.html" %}
{% load humanize %}

{% block title %}
  Browse {{ country.name }} {{ browse_type|title }}s{% ifnotequal selected_year 0 %} in {{ selected_year }}{% else %}, All years{% endifnotequal %}
{% endblock %}

{% block page_title %}
  Browse {{ country.name }} {{ browse_type|title }}s{% ifnotequal selected_year 0 %} in {{ selected_year }}{% else %}, All years{% endifnotequal %}
{% endblock %}

{% block content %}
  <div class="country_selector">  
    {% for year in years %}
      {% ifequal year.year selected_year  %}
        <strong>{{ year.year }}</strong>
      {% else %}
        {% url browse country=country.code browse_type=browse_type year=year.year sort=sort as year_url %}
        <a href="{{ year_url }}">{{ year.year }}</a>
      {% endifequal %}
    {% endfor %}
    <br />
    {% ifequal selected_year 0 %}
      All Years
    {% else %}
      <a href="{% url browse country=country.code browse_type=browse_type year='0' sort=sort %}" class="selected">All Years</a>
    {% endifequal %}
  </div>
  
  
  {% load pagination_tags %}
  {% autopaginate data 30 %}

  <table>
    <thead>
      <th>Name</th>
      <th>Amount</th>
      {% ifequal browse_type "location"  %}
      <th>Recipients</th>
      <th>Average per recipient</th>
      {% endifequal %}
    </thead>
    <tbody>
      {% for item in data %}
      <tr>
        {% ifequal browse_type "location"  %}
          {% url location_view item.country item.name as recipient_url %}
          <td><a href="{{ recipient_url }}">{{ item.name|title }}</a></td>
          <td>&euro;{{ item.total|floatformat:2|intcomma }}</td>
          <td>{{ item.count|floatformat|intcomma }}</td>
          <td>&euro;{{ item.avg|floatformat:2|intcomma }}</td>
        {% endifequal %}


        {% ifequal browse_type "scheme"  %}
          {% url scheme_view country.code item.globalschemeid as scheme_url %}
          <td><a href="{{ scheme_url }}">{{ item.name|title }}</a></td>
          <td>&euro;{{ item.amount_euro|floatformat:2|intcomma }}</td>
        {% endifequal %}
        
        
                
        {% ifequal browse_type "location"  %}
          {% url recipient_view country.code item.global_id as recipient_url %}          
          <td><a href="{{ recipient_url }}">{{ item.name|title }}</a></td>
          <td>&euro;{{ item.amount_euro|floatformat:2|intcomma }}</td>
          
        {% endifequal %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <h4 class="pager">{% paginate %}</h4>
{% endblock %}